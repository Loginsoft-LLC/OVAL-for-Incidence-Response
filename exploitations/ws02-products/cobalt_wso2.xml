<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd">
  <generator>
    <oval:product_name>Loginsoft Repository</oval:product_name>
    <oval:schema_version>5.11.2</oval:schema_version>
    <oval:timestamp>2020-12-29T18:04:15.609+05:30</oval:timestamp>
  </generator>
  <definitions>
    <definition id="oval:org.loginsoft.malware.linux.exploits.wso2:def:20220531" version="1" class="miscellaneous">
      <metadata>
        <title>Malware{Exploits-20220531}</title>
        <affected family="unix">
          <platform>Linux</platform>
        </affected>
        <reference ref_id="CVE-2022-29464" source="NVD" ref_url="https://nvd.nist.gov/vuln/detail/CVE-2022-29464"/>
        <reference ref_id="TREND MICRO" source="ThreatReport" ref_url="https://www.trendmicro.com/en_us/research/22/e/patch-your-wso2-cve-2022-29464-exploited-to-install-linux-compatible-cobalt-strike-beacons-other-malware.html"/>
        <description>Vulnerability CVE-2022-29464 being exploited in the wild since April, allowing unrestricted file uploads resulting to arbitrary remote code execution (RCE) the installation of web shells abusing the vulnerability. The location /authenticationendpoint/ appears to be a common location among WSO2 products, and we found the web shell installation for this location as well as others occurring in at least four of the seven products affected using either .JSP or .WAR files</description>
      </metadata>
      <criteria operator="OR">
        <criterion comment="Check for file hash of ^[\w]{6}\.jsp is 2effebac6dc4fe8924315403f3dbda2fddfd7ea616faaf5cac2d7f6c85254e9e" test_ref="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311000"/>
        <criterion comment="Check for file hash of temp.jsp is d2ec9ec31013320eb3f4e1886a0e1a4720919761bd0cb62dbd66a9b8f13cc23d" test_ref="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311001"/>
        <criterion comment="Check for file hash of unit.jsp is 9afec5620d7cfd959b3ec81442fefc05b4d0200194bc4443de47ea0b9f452b0f" test_ref="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311002"/>
        <criterion comment="Check for file hash of wso2is-08-22-2019_19_29.jsp is 293eca7343c5cab11427431c93f66f972ce14061691ceb9bd7546b9fb283b1d0" test_ref="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311003"/>
        <criterion comment="Check for file hash of 9.jsp is 5c0970c2c253c2120d722c37aa397b1ce5fa61108f8441a84001eed5b565dc78" test_ref="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311004"/>
        <criterion comment="Check for files ^[\w]{5}\.war in ../repository/deployment/server/webapps/" test_ref="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311005"/>
        <criterion comment="Check for file hash of Payload.class is 0c4c5c036272eb19d5617c9ce072e14ffb795a354dc682e6b0d144143ac4c7b4" test_ref="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311006"/>
        <criterion comment="Check for file hash of LBcgqCymZQhm is 4993806d2f77096ab28d589f8ee91869fc6045725ec9bc83b9e57f78cf86a5b8" test_ref="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311007"/>
        <criterion comment="Check for file hash of uCQeONYQ is 58c0dd936dd314637a7a85db5227ed0ebbfcf33508372a646c09c98ec2dd4e5d" test_ref="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311008"/>
        <criterion comment="Check for file hash of /dev/shm/hezb is aaa4aaa14e351350fccbda72d442995a65bd1bb8281d97d1153401e31365a3e9" test_ref="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311009"/>
      </criteria>
    </definition>
  </definitions>
  <tests>
    <filehash58_test check="all" check_existence="at_least_one_exists" comment="Check for file hash of ^[\w]{6}\.jsp is 2effebac6dc4fe8924315403f3dbda2fddfd7ea616faaf5cac2d7f6c85254e9e" id="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311000" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <object object_ref="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311000"/>
      <state state_ref="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311000"/>
    </filehash58_test>
    <filehash58_test check="all" check_existence="at_least_one_exists" comment="Check for file hash of temp.jsp is d2ec9ec31013320eb3f4e1886a0e1a4720919761bd0cb62dbd66a9b8f13cc23d" id="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311001" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <object object_ref="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311001"/>
      <state state_ref="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311001"/>
    </filehash58_test>
    <filehash58_test check="all" check_existence="at_least_one_exists" comment="Check for file hash of unit.jsp is 9afec5620d7cfd959b3ec81442fefc05b4d0200194bc4443de47ea0b9f452b0f" id="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311002" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <object object_ref="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311002"/>
      <state state_ref="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311002"/>
    </filehash58_test>
    <filehash58_test check="all" check_existence="at_least_one_exists" comment="Check for file hash of wso2is-08-22-2019_19_29.jsp is 293eca7343c5cab11427431c93f66f972ce14061691ceb9bd7546b9fb283b1d0" id="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311003" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <object object_ref="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311003"/>
      <state state_ref="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311003"/>
    </filehash58_test>
    <filehash58_test check="all" check_existence="at_least_one_exists" comment="Check for file hash of 9.jsp is 5c0970c2c253c2120d722c37aa397b1ce5fa61108f8441a84001eed5b565dc78" id="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311004" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <object object_ref="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311004"/>
      <state state_ref="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311004"/>
    </filehash58_test>
    <file_test check="at least one" check_existence="at_least_one_exists" comment="Check for files ^[\w]{5}\.war in ../repository/deployment/server/webapps/" id="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311005" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix">
      <object object_ref="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311005"/>
    </file_test>
    <filehash58_test check="all" check_existence="at_least_one_exists" comment="Check for file hash of Payload.class is 0c4c5c036272eb19d5617c9ce072e14ffb795a354dc682e6b0d144143ac4c7b4" id="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311006" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <object object_ref="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311006"/>
      <state state_ref="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311006"/>
    </filehash58_test>
    <filehash58_test check="all" check_existence="at_least_one_exists" comment="Check for file hash of LBcgqCymZQhm is 4993806d2f77096ab28d589f8ee91869fc6045725ec9bc83b9e57f78cf86a5b8" id="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311007" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <object object_ref="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311007"/>
      <state state_ref="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311007"/>
    </filehash58_test>
    <filehash58_test check="all" check_existence="at_least_one_exists" comment="Check for file hash of uCQeONYQ is 58c0dd936dd314637a7a85db5227ed0ebbfcf33508372a646c09c98ec2dd4e5d" id="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311008" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <object object_ref="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311008"/>
      <state state_ref="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311008"/>
    </filehash58_test>
    <filehash58_test check="all" check_existence="at_least_one_exists" comment="Check for file hash of /dev/shm/hezb is aaa4aaa14e351350fccbda72d442995a65bd1bb8281d97d1153401e31365a3e9" id="oval:org.loginsoft.malware.linux.exploits.wso2:tst:202205311009" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <object object_ref="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311009"/>
      <state state_ref="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311009"/>
    </filehash58_test>
  </tests>
  <objects>
    <filehash58_object comment="check file hash of ^[\w]{6}\.jsp" id="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311000" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <path operation="pattern match">^/(home/)?usr/(lib|lib64)/[Ww][Ss][Oo]2/[\w/ \+\.-]+/repository/deployment/server/webapps/authenticationendpoint</path>
      <filename operation="pattern match">^[\w]{6}\.jsp</filename>
      <hash_type>SHA-256</hash_type>
    </filehash58_object>
    <filehash58_object comment="check file hash of temp.jsp" id="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311001" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <path operation="pattern match">^/(home/)?usr/(lib|lib64)/[Ww][Ss][Oo]2/[\w/ \+\.-]+/repository/deployment/server/webapps/authenticationendpoint</path>
      <filename>temp.jsp</filename>
      <hash_type>SHA-256</hash_type>
    </filehash58_object>
    <filehash58_object comment="check file hash of unit.jsp" id="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311002" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <path operation="pattern match">^/(home/)?usr/(lib|lib64)/[Ww][Ss][Oo]2/[\w/ \+\.-]+/repository/deployment/server/webapps/authenticationendpoint</path>
      <filename>unit.jsp</filename>
      <hash_type>SHA-256</hash_type>
    </filehash58_object>
    <filehash58_object comment="check file hash of wso2is-08-22-2019_19_29.jsp" id="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311003" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <path operation="pattern match">^/(home/)?usr/(lib|lib64)/[Ww][Ss][Oo]2/[\w/ \+\.-]+/repository/deployment/server/webapps/authenticationendpoint</path>
      <filename>wso2is-08-22-2019_19_29.jsp</filename>
      <hash_type>SHA-256</hash_type>
    </filehash58_object>
    <filehash58_object comment="check file hash of 9.jsp" id="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311004" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <path operation="pattern match">^/(home/)?usr/(lib|lib64)/[Ww][Ss][Oo]2/[\w/ \+\.-]+/repository/deployment/server/webapps/authenticationendpoint</path>
      <filename>9.jsp</filename>
      <hash_type>SHA-256</hash_type>
    </filehash58_object>
    <file_object comment="Object for ^[\w]{5}\.war file paths" id="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311005" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix">
      <path operation="pattern match">^/(home/)?usr/(lib|lib64)/[Ww][Ss][Oo]2/[\w/ \+\.-]+/repository/deployment/server/webapps</path>
      <filename operation="pattern match">^[\w]{5}\.war</filename>
    </file_object>

    <filehash58_object comment="check file hash of Payload.class" id="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311006" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <path operation="pattern match">^/(home/)?usr/(lib|lib64)/[Ww][Ss][Oo]2/[\w/ \+\.-]+/repository/deployment/server/webapps/[\w]{5}/WEB-INF/classes/metasploit</path>
      <filename>Payload.class</filename>
      <hash_type>SHA-256</hash_type>
    </filehash58_object>
    <filehash58_object comment="check file hash of LBcgqCymZQhm" id="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311007" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <path operation="pattern match">^/(home/)?usr/(lib|lib64)/[Ww][Ss][Oo]2/[\w/ \+\.-]+/tmp</path>
      <filename>LBcgqCymZQhm</filename>
      <hash_type>SHA-256</hash_type>
    </filehash58_object>
    <filehash58_object comment="check file hash of uCQeONYQ" id="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311008" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <path operation="pattern match">^/(home/)?usr/(lib|lib64)/[Ww][Ss][Oo]2/[\w/ \+\.-]+/tmp</path>
      <filename>uCQeONYQ</filename>
      <hash_type>SHA-256</hash_type>
    </filehash58_object>
    <filehash58_object comment="check file hash of hezb" id="oval:org.loginsoft.malware.linux.exploits.wso2:obj:202205311009" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <path>/dev/shm</path>
      <filename>hezb</filename>
      <hash_type>SHA-256</hash_type>
    </filehash58_object>
  </objects>
  <states>
    <filehash58_state comment="checking for ^[\w]{6}\.jsp sha256 hash" id="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311000" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <hash operation="case insensitive equals">2effebac6dc4fe8924315403f3dbda2fddfd7ea616faaf5cac2d7f6c85254e9e</hash>
    </filehash58_state>
    <filehash58_state comment="checking for temp.jsp sha256 hash" id="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311001" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <hash operation="case insensitive equals">d2ec9ec31013320eb3f4e1886a0e1a4720919761bd0cb62dbd66a9b8f13cc23d</hash>
    </filehash58_state>
    <filehash58_state comment="checking for unit.jsp sha256 hash" id="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311002" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <hash operation="case insensitive equals">9afec5620d7cfd959b3ec81442fefc05b4d0200194bc4443de47ea0b9f452b0f</hash>
    </filehash58_state>
    <filehash58_state comment="checking for wso2is-08-22-2019_19_29.jsp sha256 hash" id="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311003" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <hash operation="case insensitive equals">293eca7343c5cab11427431c93f66f972ce14061691ceb9bd7546b9fb283b1d0</hash>
    </filehash58_state>
    <filehash58_state comment="checking for 9.jsp sha256 hash" id="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311004" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <hash operation="case insensitive equals">5c0970c2c253c2120d722c37aa397b1ce5fa61108f8441a84001eed5b565dc78</hash>
    </filehash58_state>
    <filehash58_state comment="checking for Payload.class sha256 hash" id="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311006" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <hash operation="case insensitive equals">0c4c5c036272eb19d5617c9ce072e14ffb795a354dc682e6b0d144143ac4c7b4</hash>
    </filehash58_state>
    <filehash58_state comment="checking for LBcgqCymZQhm sha256 hash" id="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311007" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <hash operation="case insensitive equals">4993806d2f77096ab28d589f8ee91869fc6045725ec9bc83b9e57f78cf86a5b8</hash>
    </filehash58_state>
    <filehash58_state comment="checking for uCQeONYQ sha256 hash" id="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311008" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <hash operation="case insensitive equals">58c0dd936dd314637a7a85db5227ed0ebbfcf33508372a646c09c98ec2dd4e5d</hash>
    </filehash58_state>
    <filehash58_state comment="checking for hezb sha256 hash" id="oval:org.loginsoft.malware.linux.exploits.wso2:ste:202205311009" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
      <hash operation="case insensitive equals">aaa4aaa14e351350fccbda72d442995a65bd1bb8281d97d1153401e31365a3e9</hash>
    </filehash58_state>
  </states>
</oval_definitions>
